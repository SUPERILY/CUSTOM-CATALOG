"use strict";(()=>{var e={};e.id=444,e.ids=[444,660],e.modules={1323:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},2008:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>y,default:()=>u,getServerSideProps:()=>m,getStaticPaths:()=>h,getStaticProps:()=>p,reportWebVitals:()=>x,routeModule:()=>N,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>f});var s=r(7093),i=r(5244),o=r(1323),d=r(2899),l=r.n(d),n=r(6814),c=r(370),g=e([n]);n=(g.then?(await g)():g)[0];let u=(0,o.l)(c,"default"),p=(0,o.l)(c,"getStaticProps"),h=(0,o.l)(c,"getStaticPaths"),m=(0,o.l)(c,"getServerSideProps"),y=(0,o.l)(c,"config"),x=(0,o.l)(c,"reportWebVitals"),f=(0,o.l)(c,"unstable_getStaticProps"),b=(0,o.l)(c,"unstable_getStaticPaths"),j=(0,o.l)(c,"unstable_getStaticParams"),v=(0,o.l)(c,"unstable_getServerProps"),w=(0,o.l)(c,"unstable_getServerSideProps"),N=new s.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/admin/categories",pathname:"/admin/categories",bundlePath:"",filename:""},components:{App:n.default,Document:l()},userland:c});a()}catch(e){a(e)}})},7886:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(1462).Z)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},5197:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(1462).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3416:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(1462).Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},8453:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(1462).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5809:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(1462).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},5451:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(1462).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},370:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var a=r(997),s=r(6689),i=r(6619),o=r(7969),d=r(5197),l=r(8453),n=r(5809),c=r(8154),g=r(3416),u=r(5451);let p=()=>{let[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)([]),[p,h]=(0,s.useState)(!0),[m,y]=(0,s.useState)(""),[x,f]=(0,s.useState)(0),[b,j]=(0,s.useState)(!1),[v,w]=(0,s.useState)(null),[N,P]=(0,s.useState)(""),[S,k]=(0,s.useState)(0),E=async()=>{h(!0);try{let[e,r]=await Promise.all([fetch("/api/categories"),fetch("/api/products")]);if(!e.ok||!r.ok)throw Error("Failed to fetch data");let a=await e.json(),s=await r.json();t(a.sort((e,t)=>e.displayOrder-t.displayOrder)),i(s)}catch(e){console.error("Failed to fetch data:",e),alert("Error loading categories. Please refresh the page.")}finally{h(!1)}};(0,s.useEffect)(()=>{E()},[]);let Z=async r=>{if(r.preventDefault(),m.trim()){j(!0);try{let r=await fetch("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m.trim(),displayOrder:x})});if(!r.ok)throw Error("Failed to add category");let a=await r.json();t([...e,a].sort((e,t)=>e.displayOrder-t.displayOrder)),y(""),f(0)}catch(e){console.error("Failed to add category:",e),alert("Error adding category.")}finally{j(!1)}}},O=e=>{w(e.id),P(e.name),k(e.displayOrder)},A=()=>{w(null),P(""),k(0)},C=async r=>{if(N.trim())try{let a=await fetch("/api/categories",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:r,name:N.trim(),displayOrder:S})});if(!a.ok)throw Error("Failed to update category");let s=await a.json();t(e.map(e=>e.id===r?s:e).sort((e,t)=>e.displayOrder-t.displayOrder)),A()}catch(e){console.error("Failed to update category:",e),alert("Error updating category.")}},M=async a=>{let s=r.filter(e=>e.categoryId===a).length,i=s>0?`Warning: ${s} product(s) are in this category. Deleting the category will NOT delete the products, but they will become uncategorized. Continue?`:"Are you sure you want to delete this category?";if(window.confirm(i))try{if(!(await fetch(`/api/categories?id=${a}`,{method:"DELETE"})).ok)throw Error("Failed to delete category");t(e.filter(e=>e.id!==a))}catch(e){console.error("Failed to delete category:",e),alert("Error deleting category. Make sure no products are assigned to it.")}};return(0,a.jsxs)("div",{className:"space-y-6 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-indigo-100 p-2 rounded-lg",children:a.jsx(o.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Category Management"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Manage product categories and their display order."})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Category"}),(0,a.jsxs)("form",{onSubmit:Z,className:"flex flex-col sm:flex-row gap-3",children:[a.jsx("input",{type:"text",placeholder:"Category Name",className:"flex-grow px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",value:m,onChange:e=>y(e.target.value)}),a.jsx("input",{type:"number",placeholder:"Order",className:"w-24 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",value:x,onChange:e=>f(parseInt(e.target.value,10)||0)}),(0,a.jsxs)("button",{type:"submit",disabled:b||!m.trim(),className:"px-6 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 disabled:opacity-50 flex items-center justify-center gap-2 transition-colors",children:[b?a.jsx(d.Z,{className:"w-4 h-4 animate-spin"}):a.jsx(l.Z,{className:"w-4 h-4"}),"Add"]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-100",children:(0,a.jsxs)("h3",{className:"font-semibold text-gray-700",children:["Existing Categories (",e.length,")"]})}),p?a.jsx("div",{className:"p-8 flex justify-center",children:a.jsx(d.Z,{className:"w-8 h-8 text-indigo-600 animate-spin"})}):0===e.length?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"No categories found."}):a.jsx("ul",{className:"divide-y divide-gray-100",children:e.map(e=>{let t=r.filter(t=>t.categoryId===e.id).length,s=v===e.id;return a.jsx("li",{className:"p-4 hover:bg-gray-50 transition-colors",children:a.jsx("div",{className:"flex items-center justify-between gap-4",children:s?(0,a.jsxs)("div",{className:"flex-grow flex items-center gap-3",children:[a.jsx("input",{type:"text",value:N,onChange:e=>P(e.target.value),className:"flex-grow px-3 py-1.5 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500",autoFocus:!0}),a.jsx("input",{type:"number",value:S,onChange:e=>k(parseInt(e.target.value,10)||0),className:"w-24 px-3 py-1.5 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500"}),a.jsx("button",{onClick:()=>C(e.id),className:"p-2 text-green-600 hover:bg-green-50 rounded-md",title:"Save",children:a.jsx(n.Z,{className:"w-4 h-4"})}),a.jsx("button",{onClick:A,className:"p-2 text-gray-400 hover:bg-gray-100 rounded-md",title:"Cancel",children:a.jsx(c.Z,{className:"w-4 h-4"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-xs font-mono bg-gray-100 text-gray-500 rounded-full w-8 h-8 flex items-center justify-center",children:e.displayOrder}),a.jsx("span",{className:"font-medium text-gray-800",children:e.name}),(0,a.jsxs)("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-500 rounded-full",children:[t," products"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>O(e),className:"p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors",title:"Edit",children:a.jsx(g.Z,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>M(e.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:a.jsx(u.Z,{className:"w-4 h-4"})})]})]})})},e.id)})})]})]})};p.getLayout=function(e){return a.jsx(i.AdminLayout,{children:e})};let h=p},5244:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},6201:e=>{e.exports=import("react-hot-toast")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[567,48,899,238],()=>r(2008));module.exports=a})();