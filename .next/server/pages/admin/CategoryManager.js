(()=>{var e={};e.id=133,e.ids=[133,888,660],e.modules={1323:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},7480:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>x,default:()=>g,getServerSideProps:()=>p,getStaticPaths:()=>h,getStaticProps:()=>m,reportWebVitals:()=>y,routeModule:()=>S,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>j,unstable_getStaticParams:()=>w,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>f});var s=a(7093),i=a(5244),n=a(1323),l=a(2899),o=a.n(l),d=a(6814),c=a(845),u=e([d]);d=(u.then?(await u)():u)[0];let g=(0,n.l)(c,"default"),m=(0,n.l)(c,"getStaticProps"),h=(0,n.l)(c,"getStaticPaths"),p=(0,n.l)(c,"getServerSideProps"),x=(0,n.l)(c,"config"),y=(0,n.l)(c,"reportWebVitals"),f=(0,n.l)(c,"unstable_getStaticProps"),b=(0,n.l)(c,"unstable_getStaticPaths"),w=(0,n.l)(c,"unstable_getStaticParams"),v=(0,n.l)(c,"unstable_getServerProps"),j=(0,n.l)(c,"unstable_getServerSideProps"),S=new s.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/admin/CategoryManager",pathname:"/admin/CategoryManager",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:c});r()}catch(e){r(e)}})},862:(e,t,a)=>{"use strict";a.d(t,{A:()=>h});var r=a(997),s=a(6689),i=a.n(s),n=a(1664),l=a.n(n),o=a(1163),d=a(5261),c=a(3460),u=a(8154),g=a(760),m=a(5781);let h=({children:e})=>{let t=(0,o.useRouter)(),[a,s]=i().useState(!1),{settings:n}=(0,m.T)();return t.pathname.startsWith("/admin"),(0,r.jsxs)("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[(0,r.jsxs)("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:[r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[r.jsx("div",{className:"flex items-center",children:(0,r.jsxs)(l(),{href:"/",className:"flex-shrink-0 flex items-center gap-3 group",children:[n?.logoUrl?r.jsx("img",{src:n.logoUrl,alt:n.storeName,className:"h-10 w-auto object-contain"}):r.jsx("div",{className:"bg-gradient-to-br from-yellow-600 to-yellow-800 text-white p-1.5 rounded-lg shadow-sm",children:r.jsx(d.Z,{className:"h-6 w-6"})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-display font-bold text-xl tracking-wide text-transparent bg-clip-text bg-gradient-to-r from-yellow-700 via-yellow-600 to-yellow-800 uppercase leading-none",children:n?.storeName||"Eljarjini"}),!n?.logoUrl&&r.jsx("span",{className:"font-display italic text-sm text-yellow-600 leading-none self-end -mt-1",children:"Complexe"})]})]})}),(0,r.jsxs)("div",{className:"hidden sm:flex sm:items-center sm:gap-6",children:[r.jsx(l(),{href:"/",className:"text-gray-600 hover:text-yellow-700 font-medium transition-colors",children:"Catalog"}),(0,r.jsxs)(l(),{href:"/admin",className:"flex items-center gap-1 text-gray-500 hover:text-gray-900 font-medium transition-colors",children:[r.jsx(c.Z,{className:"h-4 w-4"}),"Admin"]})]}),r.jsx("div",{className:"flex items-center sm:hidden",children:r.jsx("button",{onClick:()=>s(!a),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none",children:a?r.jsx(u.Z,{className:"h-6 w-6"}):r.jsx(g.Z,{className:"h-6 w-6"})})})]})}),a&&r.jsx("div",{className:"sm:hidden bg-white border-t",children:(0,r.jsxs)("div",{className:"pt-2 pb-3 space-y-1",children:[r.jsx(l(),{href:"/",onClick:()=>s(!1),className:"block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-gray-600 hover:bg-gray-50 hover:border-yellow-500 hover:text-yellow-700",children:"Catalog"}),r.jsx(l(),{href:"/admin",onClick:()=>s(!1),className:"block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-gray-600 hover:bg-gray-50 hover:border-gray-500 hover:text-gray-700",children:"Admin Console"})]})})]}),r.jsx("main",{className:"flex-grow w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e}),r.jsx("footer",{className:"bg-white border-t mt-auto",children:r.jsx("div",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("p",{className:"text-center text-gray-400 text-sm",children:["\xa9 ",new Date().getFullYear()," Eljarjini Complexe. All rights reserved."]})})})]})}},332:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{C:()=>o,V:()=>l});var s=a(997);a(6689);var i=a(6201),n=e([i]);i=(n.then?(await n)():n)[0];let l=({children:e})=>(0,s.jsxs)(s.Fragment,{children:[e,s.jsx(i.Toaster,{position:"top-right",reverseOrder:!1,gutter:8,toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",padding:"16px",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},success:{duration:3e3,iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]}),o={success:e=>i.toast.success(e),error:e=>i.toast.error(e),loading:e=>i.toast.loading(e),promise:(e,t)=>i.toast.promise(e,t)};r()}catch(e){r(e)}})},4566:(e,t,a)=>{"use strict";a.d(t,{U:()=>n,s:()=>l});var r=a(997),s=a(6689);let i=(0,s.createContext)(void 0),n=({children:e})=>{let[t,a]=(0,s.useState)([]),[n,l]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/stock-status");if(e.ok){let t=await e.json();a(t)}}catch(e){console.error("Failed to fetch stock statuses:",e)}finally{l(!1)}})()},[]),r.jsx(i.Provider,{value:{statuses:t,getStatusColor:e=>{let a=t.find(t=>t.value===e);return a?a.color:"gray"},getStatusLabel:e=>{let a=t.find(t=>t.value===e);return a?a.label:e},loading:n},children:e})},l=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useStockStatus must be used within a StockStatusProvider");return e}},5781:(e,t,a)=>{"use strict";a.d(t,{T:()=>l,_:()=>n});var r=a(997),s=a(6689);let i=(0,s.createContext)(void 0),n=({children:e})=>{let[t,a]=(0,s.useState)(null),[n,l]=(0,s.useState)(!0),o=async()=>{try{let e=await fetch("/api/settings");if(e.ok){let t=await e.json();a(t)}}catch(e){console.error("Failed to fetch store settings:",e)}finally{l(!1)}};return(0,s.useEffect)(()=>{o()},[]),r.jsx(i.Provider,{value:{settings:t,loading:n,refreshSettings:o},children:e})},l=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useStoreSettings must be used within a StoreSettingsProvider");return e}},7969:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(1462).Z)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]])},5197:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(1462).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3416:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(1462).Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},8453:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(1462).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5809:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(1462).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},5451:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(1462).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},6814:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>c});var s=a(997);a(2379);var i=a(862),n=a(332),l=a(4566),o=a(5781),d=e([n]);n=(d.then?(await d)():d)[0];let c=function({Component:e,pageProps:t}){let a=e.getLayout??(e=>s.jsx(i.A,{children:e}));return s.jsx(n.V,{children:s.jsx(l.U,{children:s.jsx(o._,{children:a(s.jsx(e,{...t}))})})})};r()}catch(e){r(e)}})},845:(e,t,a)=>{"use strict";a.r(t),a.d(t,{CategoryManager:()=>m});var r=a(997),s=a(6689),i=a(1227),n=a(7969),l=a(5197),o=a(8453),d=a(5809),c=a(8154),u=a(3416),g=a(5451);let m=()=>{let[e,t]=(0,s.useState)([]),[a,m]=(0,s.useState)([]),[h,p]=(0,s.useState)(!0),[x,y]=(0,s.useState)(""),[f,b]=(0,s.useState)(!1),[w,v]=(0,s.useState)(null),[j,S]=(0,s.useState)(""),k=async()=>{p(!0);let[e,a]=await Promise.all([i.DB.getCategories(),i.DB.getProducts()]);t(e),m(a),p(!1)};(0,s.useEffect)(()=>{k()},[]);let N=async a=>{if(a.preventDefault(),!x.trim())return;b(!0);let r={id:crypto.randomUUID(),name:x.trim(),displayOrder:e.length,createdAt:new Date,updatedAt:new Date};await i.DB.saveCategory(r),t([...e,r]),y(""),b(!1)},P=e=>{v(e.id),S(e.name)},C=()=>{v(null),S("")},M=async r=>{let s=e.find(e=>e.id===r);if(s&&j.trim()&&(t(e.map(e=>e.id===r?{...e,name:j.trim()}:e)),v(null),await i.DB.saveCategory({id:r,name:j.trim(),displayOrder:s.displayOrder}),s.name!==j.trim())){let e=a.filter(e=>e.category.name===s.name);e.length>0&&(await Promise.all(e.map(e=>i.DB.saveProduct({id:e.id,name:e.name,sku:e.sku,price:e.price,hidePrice:e.hidePrice,description:e.description,stockStatus:e.stockStatus,categoryId:e.categoryId,features:e.features.map(e=>e.text),images:e.images.map(e=>e.url)}))),m(await i.DB.getProducts()))}},A=async(r,s)=>{let n=a.filter(e=>e.category.name===s).length,l=n>0?`Warning: ${n} product(s) are in this category. Deleting it will leave them uncategorized (or keep the old tag). Continue?`:"Are you sure you want to delete this category?";window.confirm(l)&&(await i.DB.deleteCategory(r),t(e.filter(e=>e.id!==r)))};return(0,r.jsxs)("div",{className:"space-y-6 max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"bg-indigo-100 p-2 rounded-lg",children:r.jsx(n.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Category Management"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Manage product categories and organize your catalog."})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Category"}),(0,r.jsxs)("form",{onSubmit:N,className:"flex gap-3",children:[r.jsx("input",{type:"text",placeholder:"Enter category name (e.g., Office Supplies)",className:"flex-grow px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",value:x,onChange:e=>y(e.target.value)}),(0,r.jsxs)("button",{type:"submit",disabled:f||!x.trim(),className:"px-6 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 transition-colors",children:[f?r.jsx(l.Z,{className:"w-4 h-4 animate-spin"}):r.jsx(o.Z,{className:"w-4 h-4"}),"Add"]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[r.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-100",children:(0,r.jsxs)("h3",{className:"font-semibold text-gray-700",children:["Existing Categories (",e.length,")"]})}),h?r.jsx("div",{className:"p-8 flex justify-center",children:r.jsx(l.Z,{className:"w-8 h-8 text-indigo-600 animate-spin"})}):0===e.length?r.jsx("div",{className:"p-8 text-center text-gray-500",children:"No categories found. Create one above to get started."}):r.jsx("ul",{className:"divide-y divide-gray-100",children:e.map(e=>{let t=a.filter(t=>t.category.name===e.name).length,s=w===e.id;return r.jsx("li",{className:"p-4 hover:bg-gray-50 transition-colors",children:r.jsx("div",{className:"flex items-center justify-between gap-4",children:s?(0,r.jsxs)("div",{className:"flex-grow flex items-center gap-3",children:[r.jsx("input",{type:"text",value:j,onChange:e=>S(e.target.value),className:"flex-grow px-3 py-1.5 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500",autoFocus:!0}),r.jsx("button",{onClick:()=>M(e.id),className:"p-2 text-green-600 hover:bg-green-50 rounded-md",title:"Save",children:r.jsx(d.Z,{className:"w-4 h-4"})}),r.jsx("button",{onClick:C,className:"p-2 text-gray-400 hover:bg-gray-100 rounded-md",title:"Cancel",children:r.jsx(c.Z,{className:"w-4 h-4"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"font-medium text-gray-800",children:e.name}),(0,r.jsxs)("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-500 rounded-full",children:[t," products"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>P(e),className:"p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors",title:"Edit Name",children:r.jsx(u.Z,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>A(e.id,e.name),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:r.jsx(g.Z,{className:"w-4 h-4"})})]})]})})},e.id)})})]})]})}},1227:(e,t,a)=>{"use strict";let r;a.d(t,{DB:()=>s}),r=new(a(3524)).PrismaClient;let s={getProducts:async()=>await r.product.findMany({orderBy:{name:"asc"},include:{images:!0,category:!0,features:!0}}),getProductById:async e=>await r.product.findUnique({where:{id:e},include:{images:!0,category:!0,features:!0}}),saveProduct:async e=>{let{id:t,categoryId:a,features:s,images:i,...n}=e,l=s.map(e=>({text:e})),o=i.map(e=>({url:e}));return t?await r.$transaction(async e=>(await e.feature.deleteMany({where:{productId:t}}),await e.image.deleteMany({where:{productId:t}}),e.product.update({where:{id:t},data:{...n,category:{connect:{id:a}},features:{create:l},images:{create:o}},include:{images:!0,category:!0,features:!0}}))):await r.product.create({data:{...n,category:{connect:{id:a}},features:{create:l},images:{create:o}},include:{images:!0,category:!0,features:!0}})},deleteProduct:async e=>{await r.product.delete({where:{id:e}})},duplicateProduct:async e=>{let t=await r.product.findUnique({where:{id:e},include:{images:!0,category:!0,features:!0}});if(!t)throw Error("Product not found");let a=`${t.sku}-COPY`,s=1;for(;await r.product.findFirst({where:{sku:a}});)a=`${t.sku}-COPY${s}`,s++;return await r.product.create({data:{name:`${t.name} (Copy)`,sku:a,description:t.description,price:t.price,hidePrice:t.hidePrice,stockStatus:t.stockStatus,category:{connect:{id:t.categoryId}},features:{create:t.features.map(e=>({text:e.text}))},images:{create:t.images.map(e=>({url:e.url}))}},include:{images:!0,category:!0,features:!0}})},getCategories:async()=>r.category.findMany({orderBy:{displayOrder:"asc"}}),saveCategory:async e=>e.id?r.category.update({where:{id:e.id},data:e}):r.category.create({data:e}),deleteCategory:async e=>{await r.category.delete({where:{id:e}})},getBanners:async()=>r.banner.findMany({orderBy:{displayOrder:"asc"}}),getBannerById:async e=>r.banner.findUnique({where:{id:e}}),createBanner:async e=>r.banner.create({data:e}),updateBanner:async(e,t)=>r.banner.update({where:{id:e},data:t}),deleteBanner:async e=>{await r.banner.delete({where:{id:e}})},getBanner:async()=>{let e=await r.banner.findMany({where:{isActive:!0},orderBy:{displayOrder:"asc"},take:1});return e.length>0?e[0]:r.banner.create({data:{title:"Welcome to the Catalog",subtitle:"Explore our products.",imageUrl:"https://picsum.photos/seed/banner/1200/400",linkText:"Explore",linkUrl:"#catalog",isActive:!0,displayOrder:0}})},saveBanner:async e=>{let t=await r.banner.findFirst({orderBy:{displayOrder:"asc"}});return t?r.banner.update({where:{id:t.id},data:e}):r.banner.create({data:{title:e.title||"",subtitle:e.subtitle||"",imageUrl:e.imageUrl||"",mobileImageUrl:e.mobileImageUrl||null,linkText:e.linkText||"",linkUrl:e.linkUrl||"",isActive:e.isActive??!0,displayOrder:e.displayOrder??0}})},async getStockStatuses(){return 0===await r.stockStatus.count()&&await this.seedStockStatuses(),r.stockStatus.findMany({orderBy:{label:"asc"}})},createStockStatus:async e=>r.stockStatus.create({data:{...e,isDefault:!1}}),updateStockStatus:async(e,t)=>r.stockStatus.update({where:{id:e},data:t}),deleteStockStatus:async e=>r.stockStatus.delete({where:{id:e}}),async seedStockStatuses(){for(let e of[{label:"In Stock",value:"IN_STOCK",color:"green"},{label:"Low Stock",value:"LOW_STOCK",color:"yellow"},{label:"Out of Stock",value:"OUT_OF_STOCK",color:"red"},{label:"Backorder",value:"BACKORDER",color:"orange"}])await r.stockStatus.upsert({where:{value:e.value},update:{},create:{label:e.label,value:e.value,color:e.color,isDefault:!0}})},async getStoreSettings(){let e=await r.storeSettings.findUnique({where:{id:"default"}});return e||(e=await r.storeSettings.create({data:{id:"default",storeName:"Eljarjini Complexe"}})),e},async updateStoreSettings(e){return await this.getStoreSettings(),r.storeSettings.update({where:{id:"default"},data:e})}}},2379:()=>{},5244:(e,t)=>{"use strict";var a;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))},3524:e=>{"use strict";e.exports=require("@prisma/client")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},6201:e=>{"use strict";e.exports=import("react-hot-toast")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},9796:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[567,48,899],()=>a(7480));module.exports=r})();