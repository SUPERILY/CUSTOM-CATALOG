(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[209],{1204:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/products",function(){return s(2776)}])},3552:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(1462).Z)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},4672:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(1462).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},2776:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return O}});var r=s(5893),a=s(7294),o=s(1664),c=s.n(o),d=s(5675),i=s.n(d),l=s(3270),n=s(3552),u=s(8453),h=s(4672),p=s(1462);let x=(0,p.Z)("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),m=(0,p.Z)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var g=s(5197),y=s(7886),f=s(7233);let j=(0,p.Z)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var w=s(3416),b=s(5451),N=s(7183);let v=e=>{let t=e=>{if(null==e)return"";let t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?'"'.concat(t.replace(/"/g,'""'),'"'):t};return["SKU,Name,Description,Price,Category,Stock Status,Hide Price,Features,Image URLs,Created At",...e.map(e=>{var s;let r=e.features.map(e=>e.text).join("; "),a=e.images.map(e=>e.url).join("; ");return[t(e.sku),t(e.name),t(e.description),t(e.price.toFixed(2)),t((null===(s=e.category)||void 0===s?void 0:s.name)||""),t(e.stockStatus.replace(/_/g," ")),t(e.hidePrice?"Yes":"No"),t(r),t(a),t(new Date(e.createdAt).toISOString())].join(",")})].join("\n")},k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"products.csv",s=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),a=URL.createObjectURL(s);r.setAttribute("href",a),r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)},S=["IN_STOCK","LOW_STOCK","OUT_OF_STOCK","BACKORDER"],C=()=>{let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(!0),[d,l]=(0,a.useState)(""),[p,C]=(0,a.useState)(new Set),O=async()=>{o(!0);try{let e=await fetch("/api/products");if(!e.ok)throw Error("Failed to fetch products");let s=await e.json();t(s)}catch(e){console.error("Failed to fetch products:",e),N.C.error("Failed to load products")}finally{o(!1)}};(0,a.useEffect)(()=>{O()},[]);let F=async(s,r)=>{let a=[...e];t(e=>e.map(e=>e.id===s.id?{...e,stockStatus:r}:e));try{let e={...s,stockStatus:r,categoryId:s.category.id,features:s.features.map(e=>e.text),images:s.images.map(e=>e.url)};if(!(await fetch("/api/products/".concat(s.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to update stock");N.C.success("Stock status updated")}catch(e){console.error("Failed to update stock:",e),t(a),N.C.error("Failed to update stock status")}},_=async e=>{if(window.confirm("Are you sure you want to delete this product? This cannot be undone."))try{if(!(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete product");t(t=>t.filter(t=>t.id!==e)),N.C.success("Product deleted successfully")}catch(e){console.error("Failed to delete product:",e),N.C.error("Failed to delete product")}},T=async e=>{try{let s=await fetch("/api/products/".concat(e,"/duplicate"),{method:"POST"});if(!s.ok)throw Error("Failed to duplicate product");let r=await s.json();t(e=>[...e,r]),N.C.success("Product duplicated successfully")}catch(e){console.error("Failed to duplicate product:",e),N.C.error("Failed to duplicate product")}},E=async()=>{if(0!==p.size&&window.confirm("Are you sure you want to delete ".concat(p.size," product(s)? This cannot be undone.")))try{let e=await fetch("/api/products/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productIds:Array.from(p)})});if(!e.ok)throw Error("Failed to delete products");let s=await e.json();t(e=>e.filter(e=>!p.has(e.id))),C(new Set),N.C.success(s.message)}catch(e){console.error("Failed to bulk delete:",e),N.C.error("Failed to delete products")}},P=async e=>{if(0!==p.size)try{let s=await fetch("/api/products/bulk-update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productIds:Array.from(p),stockStatus:e})});if(!s.ok)throw Error("Failed to update products");let r=await s.json();t(t=>t.map(t=>p.has(t.id)?{...t,stockStatus:e}:t)),C(new Set),N.C.success(r.message)}catch(e){console.error("Failed to bulk update:",e),N.C.error("Failed to update products")}},L=e=>{let t=new Set(p);t.has(e)?t.delete(e):t.add(e),C(t)},Z=e.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.sku.toLowerCase().includes(d.toLowerCase())),A=Z.length>0&&p.size===Z.length;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Product Management"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{let e=v(Z),t=new Date().toISOString().split("T")[0];k(e,"products-".concat(t,".csv")),N.C.success("CSV exported successfully")},className:"inline-flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors shadow-sm",children:[(0,r.jsx)(n.Z,{className:"w-4 h-4"})," Export CSV"]}),(0,r.jsxs)(c(),{href:"/admin/product/edit/new",className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[(0,r.jsx)(u.Z,{className:"w-4 h-4"})," Add New Product"]})]})]}),p.size>0&&(0,r.jsxs)("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-indigo-900 font-medium",children:[p.size," product(s) selected"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("select",{onChange:e=>{e.target.value&&(P(e.target.value),e.target.value="")},className:"px-3 py-1.5 border border-indigo-300 rounded-md bg-white text-sm",defaultValue:"",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Update Stock Status"}),S.map(e=>(0,r.jsx)("option",{value:e,children:e.replace(/_/g," ")},e))]}),(0,r.jsx)("button",{onClick:E,className:"px-4 py-1.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-medium",children:"Delete Selected"})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-4 border-b bg-gray-50 flex items-center gap-4",children:(0,r.jsxs)("div",{className:"relative flex-grow max-w-md",children:[(0,r.jsx)(h.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search by name or SKU...",className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-indigo-500",value:d,onChange:e=>l(e.target.value)})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50 text-gray-500 font-medium border-b",children:[(0,r.jsx)("th",{className:"px-6 py-3",children:(0,r.jsx)("button",{onClick:()=>{p.size===Z.length?C(new Set):C(new Set(Z.map(e=>e.id)))},className:"flex items-center",children:A?(0,r.jsx)(x,{className:"w-5 h-5 text-indigo-600"}):(0,r.jsx)(m,{className:"w-5 h-5"})})}),(0,r.jsx)("th",{className:"px-6 py-3",children:"Product"}),(0,r.jsx)("th",{className:"px-6 py-3",children:"Category"}),(0,r.jsx)("th",{className:"px-6 py-3",children:"Price"}),(0,r.jsx)("th",{className:"px-6 py-3",children:"Stock Status (Quick Update)"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-100",children:s?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center",children:(0,r.jsx)(g.Z,{className:"w-8 h-8 text-indigo-600 animate-spin mx-auto"})})}):0===Z.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No products found."})}):Z.map(e=>{var t,s,a;let o=null===(s=e.images)||void 0===s?void 0:null===(t=s[0])||void 0===t?void 0:t.url,d=p.has(e.id);return(0,r.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors ".concat(d?"bg-indigo-50":""),children:[(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("button",{onClick:()=>L(e.id),children:d?(0,r.jsx)(x,{className:"w-5 h-5 text-indigo-600"}):(0,r.jsx)(m,{className:"w-5 h-5 text-gray-400"})})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-md bg-gray-100 flex-shrink-0 flex items-center justify-center",children:o?(0,r.jsx)(i(),{src:o,alt:e.name,width:40,height:40,className:"object-cover rounded-md"}):(0,r.jsx)(y.Z,{className:"w-5 h-5 text-gray-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["SKU: ",e.sku]})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 text-gray-600",children:(null===(a=e.category)||void 0===a?void 0:a.name)||"N/A"}),(0,r.jsx)("td",{className:"px-6 py-4 font-medium text-gray-900",children:e.hidePrice?(0,r.jsxs)("div",{className:"flex items-center gap-1.5 text-gray-500",title:"Price hidden on catalog",children:[(0,r.jsx)(f.Z,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:["$",e.price.toFixed(2)]})]}):"$".concat(e.price.toFixed(2))}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("select",{value:e.stockStatus,onChange:t=>F(e,t.target.value),className:"block w-full max-w-[180px] rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-1.5 pl-3 pr-8 cursor-pointer\n                             ".concat("IN_STOCK"===e.stockStatus?"bg-green-50 text-green-700 border-green-200":"OUT_OF_STOCK"===e.stockStatus?"bg-red-50 text-red-700 border-red-200":"LOW_STOCK"===e.stockStatus?"bg-yellow-50 text-yellow-700 border-yellow-200":"bg-blue-50 text-blue-700 border-blue-200"),children:S.map(e=>(0,r.jsx)("option",{value:e,children:e.replace(/_/g," ")},e))})}),(0,r.jsx)("td",{className:"px-6 py-4 text-right",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>T(e.id),className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-md transition-colors",title:"Duplicate",children:(0,r.jsx)(j,{className:"w-4 h-4"})}),(0,r.jsx)(c(),{href:"/admin/product/edit/".concat(e.id),className:"p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors",title:"Edit",children:(0,r.jsx)(w.Z,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>_(e.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:(0,r.jsx)(b.Z,{className:"w-4 h-4"})})]})})]},e.id)})})]})})]})]})};C.getLayout=function(e){return(0,r.jsx)(l.AdminLayout,{children:e})};var O=C}},function(e){e.O(0,[335,94,888,774,179],function(){return e(e.s=1204)}),_N_E=e.O()}]);