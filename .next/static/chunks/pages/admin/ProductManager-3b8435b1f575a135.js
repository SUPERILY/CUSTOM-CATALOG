(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[923],{6511:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/ProductManager",function(){return a(518)}])},7233:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(1462).Z)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},4672:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(1462).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},518:function(e,t,a){"use strict";a.r(t),a.d(t,{ProductManager:function(){return y}});var r=a(5893),s=a(7294),c=a(1664),n=a.n(c),i=a(1227),d=a(8453),o=a(4672),l=a(5197),u=a(7233),g=a(3416),p=a(5451);let y=()=>{let[e,t]=(0,s.useState)([]),[a,c]=(0,s.useState)(!0),[y,m]=(0,s.useState)(""),x=async()=>{c(!0),t(await i.DB.getProducts()),c(!1)};(0,s.useEffect)(()=>{x()},[]);let h=async(a,r)=>{let s=e.find(e=>e.id===a);s&&(await i.DB.saveProduct({id:s.id,name:s.name,sku:s.sku,price:s.price,hidePrice:s.hidePrice,description:s.description,stockStatus:r,categoryId:s.categoryId,features:s.features.map(e=>e.text),images:s.images.map(e=>e.url)}),t(e=>e.map(e=>e.id===a?{...e,stockStatus:r}:e)))},f=async e=>{window.confirm("Are you sure you want to delete this product? This cannot be undone.")&&(await i.DB.deleteProduct(e),t(t=>t.filter(t=>t.id!==e)))},w=e.filter(e=>e.name.toLowerCase().includes(y.toLowerCase())||e.sku.toLowerCase().includes(y.toLowerCase()));return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Product Management"}),(0,r.jsxs)(n(),{href:"/admin/products/new",className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[(0,r.jsx)(d.Z,{className:"w-4 h-4"})," Add New Product"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-4 border-b bg-gray-50 flex items-center gap-4",children:(0,r.jsxs)("div",{className:"relative flex-grow max-w-md",children:[(0,r.jsx)(o.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search by name or SKU...",className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-indigo-500",value:y,onChange:e=>m(e.target.value)})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50 text-gray-500 font-medium border-b",children:[(0,r.jsx)("th",{className:"px-6 py-3",children:"Product"}),(0,r.jsx)("th",{className:"px-6 py-3",children:"Category"}),(0,r.jsx)("th",{className:"px-6 py-3",children:"Price"}),(0,r.jsx)("th",{className:"px-6 py-3",children:"Stock Status (Quick Update)"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-100",children:a?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"px-6 py-12 text-center",children:(0,r.jsx)(l.Z,{className:"w-8 h-8 text-indigo-600 animate-spin mx-auto"})})}):0===w.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:"No products found."})}):w.map(e=>{var t;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("img",{src:null===(t=e.images[0])||void 0===t?void 0:t.url,alt:"",className:"w-10 h-10 rounded-md object-cover bg-gray-200"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["SKU: ",e.sku]})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 text-gray-600",children:e.category.name}),(0,r.jsx)("td",{className:"px-6 py-4 font-medium text-gray-900",children:e.hidePrice?(0,r.jsxs)("div",{className:"flex items-center gap-1.5 text-gray-500",title:"Price hidden on catalog",children:[(0,r.jsx)(u.Z,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:["$",e.price.toFixed(2)]})]}):"$".concat(e.price.toFixed(2))}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("select",{value:e.stockStatus,onChange:t=>h(e.id,t.target.value),className:"block w-full max-w-[180px] rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-1.5 pl-3 pr-8 cursor-pointer\n                           ".concat("IN_STOCK"===e.stockStatus?"bg-green-50 text-green-700 border-green-200":"OUT_OF_STOCK"===e.stockStatus?"bg-red-50 text-red-700 border-red-200":"LOW_STOCK"===e.stockStatus?"bg-yellow-50 text-yellow-700 border-yellow-200":"bg-blue-50 text-blue-700 border-blue-200"),children:[(0,r.jsx)("option",{value:"IN_STOCK",children:"IN_STOCK"}),(0,r.jsx)("option",{value:"LOW_STOCK",children:"LOW_STOCK"}),(0,r.jsx)("option",{value:"OUT_OF_STOCK",children:"OUT_OF_STOCK"}),(0,r.jsx)("option",{value:"BACKORDER",children:"BACKORDER"})]})}),(0,r.jsx)("td",{className:"px-6 py-4 text-right",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(n(),{href:"/admin/products/edit/".concat(e.id),className:"p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors",title:"Edit",children:(0,r.jsx)(g.Z,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>f(e.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:(0,r.jsx)(p.Z,{className:"w-4 h-4"})})]})})]},e.id)})})]})})]})]})}},1227:function(e,t,a){"use strict";let r;a.d(t,{DB:function(){return s}}),r=new(a(385)).PrismaClient;let s={getProducts:async()=>await r.product.findMany({orderBy:{name:"asc"},include:{images:!0,category:!0,features:!0}}),getProductById:async e=>await r.product.findUnique({where:{id:e},include:{images:!0,category:!0,features:!0}}),saveProduct:async e=>{let{id:t,categoryId:a,features:s,images:c,...n}=e,i=s.map(e=>({text:e})),d=c.map(e=>({url:e}));return t?await r.$transaction(async e=>(await e.feature.deleteMany({where:{productId:t}}),await e.image.deleteMany({where:{productId:t}}),e.product.update({where:{id:t},data:{...n,category:{connect:{id:a}},features:{create:i},images:{create:d}},include:{images:!0,category:!0,features:!0}}))):await r.product.create({data:{...n,category:{connect:{id:a}},features:{create:i},images:{create:d}},include:{images:!0,category:!0,features:!0}})},deleteProduct:async e=>{await r.product.delete({where:{id:e}})},duplicateProduct:async e=>{let t=await r.product.findUnique({where:{id:e},include:{images:!0,category:!0,features:!0}});if(!t)throw Error("Product not found");let a="".concat(t.sku,"-COPY"),s=1;for(;await r.product.findFirst({where:{sku:a}});)a="".concat(t.sku,"-COPY").concat(s),s++;return await r.product.create({data:{name:"".concat(t.name," (Copy)"),sku:a,description:t.description,price:t.price,hidePrice:t.hidePrice,stockStatus:t.stockStatus,category:{connect:{id:t.categoryId}},features:{create:t.features.map(e=>({text:e.text}))},images:{create:t.images.map(e=>({url:e.url}))}},include:{images:!0,category:!0,features:!0}})},getCategories:async()=>r.category.findMany({orderBy:{displayOrder:"asc"}}),saveCategory:async e=>e.id?r.category.update({where:{id:e.id},data:e}):r.category.create({data:e}),deleteCategory:async e=>{await r.category.delete({where:{id:e}})},getBanners:async()=>r.banner.findMany({orderBy:{displayOrder:"asc"}}),getBannerById:async e=>r.banner.findUnique({where:{id:e}}),createBanner:async e=>r.banner.create({data:e}),updateBanner:async(e,t)=>r.banner.update({where:{id:e},data:t}),deleteBanner:async e=>{await r.banner.delete({where:{id:e}})},getBanner:async()=>{let e=await r.banner.findMany({where:{isActive:!0},orderBy:{displayOrder:"asc"},take:1});return e.length>0?e[0]:r.banner.create({data:{title:"Welcome to the Catalog",subtitle:"Explore our products.",imageUrl:"https://picsum.photos/seed/banner/1200/400",linkText:"Explore",linkUrl:"#catalog",isActive:!0,displayOrder:0}})},saveBanner:async e=>{var t,a;let s=await r.banner.findFirst({orderBy:{displayOrder:"asc"}});return s?r.banner.update({where:{id:s.id},data:e}):r.banner.create({data:{title:e.title||"",subtitle:e.subtitle||"",imageUrl:e.imageUrl||"",mobileImageUrl:e.mobileImageUrl||null,linkText:e.linkText||"",linkUrl:e.linkUrl||"",isActive:null===(t=e.isActive)||void 0===t||t,displayOrder:null!==(a=e.displayOrder)&&void 0!==a?a:0}})},async getStockStatuses(){return 0===await r.stockStatus.count()&&await this.seedStockStatuses(),r.stockStatus.findMany({orderBy:{label:"asc"}})},createStockStatus:async e=>r.stockStatus.create({data:{...e,isDefault:!1}}),updateStockStatus:async(e,t)=>r.stockStatus.update({where:{id:e},data:t}),deleteStockStatus:async e=>r.stockStatus.delete({where:{id:e}}),async seedStockStatuses(){for(let e of[{label:"In Stock",value:"IN_STOCK",color:"green"},{label:"Low Stock",value:"LOW_STOCK",color:"yellow"},{label:"Out of Stock",value:"OUT_OF_STOCK",color:"red"},{label:"Backorder",value:"BACKORDER",color:"orange"}])await r.stockStatus.upsert({where:{value:e.value},update:{},create:{label:e.label,value:e.value,color:e.color,isDefault:!0}})},async getStoreSettings(){let e=await r.storeSettings.findUnique({where:{id:"default"}});return e||(e=await r.storeSettings.create({data:{id:"default",storeName:"Eljarjini Complexe"}})),e},async updateStoreSettings(e){return await this.getStoreSettings(),r.storeSettings.update({where:{id:"default"},data:e})}}}},function(e){e.O(0,[737,888,774,179],function(){return e(e.s=6511)}),_N_E=e.O()}]);