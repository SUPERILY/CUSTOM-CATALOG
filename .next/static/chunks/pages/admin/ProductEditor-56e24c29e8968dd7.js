(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[135],{1575:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/ProductEditor",function(){return a(4688)}])},5875:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(1462).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5197:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(1462).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8453:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(1462).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5809:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(1462).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},2770:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(1462).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},4688:function(e,t,a){"use strict";a.r(t),a.d(t,{ProductEditor:function(){return g}});var s=a(5893),r=a(7294),i=a(5197),l=a(5875),o=a(8154),c=a(2770),n=a(8453),d=a(5809);let u=["IN_STOCK","LOW_STOCK","OUT_OF_STOCK","BACKORDER"],g=()=>{let[e,t]=(0,r.useState)(null),[a,g]=(0,r.useState)(!0),[m,p]=(0,r.useState)(!1),[x,h]=(0,r.useState)([]),[f,y]=(0,r.useState)({id:crypto.randomUUID(),name:"",sku:"",price:0,hidePrice:!1,description:"",features:[""],categoryId:"",images:[],stockStatus:"IN_STOCK",createdAt:new Date,updatedAt:new Date});(0,r.useEffect)(()=>{let e=window.location.pathname.split("/"),a=e[e.length-1];a&&"new"!==a&&t(a),(async()=>{try{let e=await fetch("/api/categories"),t=await e.json();if(h(t),a&&"new"!==a){let e=await fetch("/api/products/".concat(a));if(e.ok){let t=await e.json();y({...t,features:t.features.map(e=>e.text),categoryId:t.category.id})}}else t.length>0&&y(e=>({...e,categoryId:t[0].id}))}catch(e){console.error(e)}finally{g(!1)}})()},[]);let b=async e=>{if(!e.target.files||0===e.target.files.length)return;p(!0);let t=e.target.files[0],a=new FormData;a.append("file",t);try{let e=await fetch("/api/upload",{method:"POST",body:a});if(!e.ok)throw Error("Upload failed");let t=await e.json();y(e=>({...e,images:[...e.images,{id:crypto.randomUUID(),url:t.url,productId:e.id,createdAt:new Date,updatedAt:new Date}]}))}catch(e){console.error("Upload error:",e),alert("Failed to upload image.")}finally{p(!1)}},j=e=>{y(t=>({...t,images:t.images.filter((t,a)=>a!==e)}))},N=async t=>{t.preventDefault(),g(!0);let a={...f,categoryId:f.categoryId,features:f.features.filter(e=>""!==e.trim()),images:f.images.map(e=>e.url)};try{let t=e?"/api/products/".concat(e):"/api/products",s=e?"PUT":"POST";if(!(await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw Error("Failed to save");window.location.href="/admin/products"}catch(e){console.error("Save error:",e),alert("Failed to save product."),g(!1)}},w=(e,t)=>{let a=[...f.features];a[e]=t,y({...f,features:a})},v=e=>{y({...f,features:f.features.filter((t,a)=>a!==e)})};return a&&e?(0,s.jsx)("div",{className:"flex justify-center p-12",children:(0,s.jsx)(i.Z,{className:"animate-spin text-indigo-600"})}):(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,s.jsx)("a",{href:"/admin/products",className:"text-gray-500 hover:text-gray-700",children:(0,s.jsx)(l.Z,{className:"w-6 h-6"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Edit Product":"Add New Product"})]}),(0,s.jsxs)("form",{onSubmit:N,className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 sm:p-8 space-y-8",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Product Name"}),(0,s.jsx)("input",{required:!0,type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",value:f.name,onChange:e=>y({...f,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"SKU"}),(0,s.jsx)("input",{required:!0,type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",value:f.sku,onChange:e=>y({...f,sku:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,s.jsx)("select",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 bg-white",value:f.categoryId,onChange:e=>y({...f,categoryId:e.target.value}),children:x.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Price ($)"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[(0,s.jsx)("input",{required:!0,type:"number",step:"0.01",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",value:f.price,onChange:e=>y({...f,price:parseFloat(e.target.value)})}),(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-600 whitespace-nowrap select-none cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:f.hidePrice||!1,onChange:e=>y({...f,hidePrice:e.target.checked}),className:"rounded text-indigo-600 focus:ring-indigo-500 w-4 h-4"}),"Hide Price on Catalog"]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Product Images"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-4",children:[f.images.map((e,t)=>(0,s.jsxs)("div",{className:"relative w-24 h-24 rounded-lg overflow-hidden border border-gray-200 group",children:[(0,s.jsx)("img",{src:e.url,alt:"Product",className:"w-full h-full object-cover"}),(0,s.jsx)("button",{type:"button",onClick:()=>j(t),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(o.Z,{className:"w-3 h-3"})})]},t)),(0,s.jsxs)("label",{className:"w-24 h-24 flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[m?(0,s.jsx)(i.Z,{className:"w-6 h-6 animate-spin text-gray-400"}):(0,s.jsx)(c.Z,{className:"w-6 h-6 text-gray-400"}),(0,s.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Upload"}),(0,s.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:b,disabled:m})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,s.jsx)("textarea",{rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",value:f.description,onChange:e=>y({...f,description:e.target.value}),placeholder:"Enter full product description..."}),(0,s.jsx)("p",{className:"text-xs text-gray-500 text-right",children:"Powered by Gemini 2.5 Flash"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Key Features"}),f.features.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",className:"flex-grow px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",value:e,onChange:e=>w(t,e.target.value),placeholder:"e.g. Wireless Connectivity"}),(0,s.jsx)("button",{type:"button",onClick:()=>v(t),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg",children:(0,s.jsx)(o.Z,{className:"w-5 h-5"})})]},t)),(0,s.jsxs)("button",{type:"button",onClick:()=>{y({...f,features:[...f.features,""]})},className:"flex items-center gap-2 text-sm text-indigo-600 hover:text-indigo-800 font-medium",children:[(0,s.jsx)(n.Z,{className:"w-4 h-4"})," Add Feature"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Status"}),(0,s.jsx)("div",{className:"flex gap-4 flex-wrap",children:u.map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 rounded-lg border cursor-pointer transition-all ".concat(f.stockStatus===e?"bg-indigo-50 border-indigo-500 text-indigo-700":"bg-white border-gray-200 hover:bg-gray-50"),children:[(0,s.jsx)("input",{type:"radio",name:"stockStatus",value:e,checked:f.stockStatus===e,onChange:e=>y({...f,stockStatus:e.target.value}),className:"text-indigo-600 focus:ring-indigo-500"}),e]},e))})]}),(0,s.jsxs)("div",{className:"pt-6 border-t flex justify-end gap-4",children:[(0,s.jsx)("a",{href:"/admin/products",className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 font-medium",children:"Cancel"}),(0,s.jsxs)("button",{type:"submit",disabled:a,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 shadow-md font-medium flex items-center gap-2 disabled:opacity-70",children:[a&&(0,s.jsx)(i.Z,{className:"w-4 h-4 animate-spin"}),(0,s.jsx)(d.Z,{className:"w-4 h-4"}),"Save Product"]})]})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=1575)}),_N_E=e.O()}]);